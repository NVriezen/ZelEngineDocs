


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Entities &mdash; Zel Game Engine 0.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Components" href="components.html" />
    <link rel="prev" title="Levels" href="levels.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #081335" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/docs_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">About:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/philosofy.html">Philosofy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/platforms.html">Platforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/platforms.html#supported-developement-platforms">Supported Developement Platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/platforms.html#supported-build-platforms">Supported Build Platforms</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#downloading-the-engine">Downloading The Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#cloning-the-repository">Cloning The Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#downloading-the-repository">Downloading The Repository</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#setting-up-visual-studio">Setting Up Visual Studio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#configurations">Configurations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#testing-the-setup">Testing the setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#what-s-next">What’s Next?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#coming-from-a-different-engine">Coming from a different engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#user-code">User Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#initialization">Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#logic">Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#render">Render</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#termination">Termination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#including">Including</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#what-s-next">What’s Next?</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="migrationguide.html">Differences Between Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="levels.html">Levels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="levels.html#creating-a-level">Creating a level</a></li>
<li class="toctree-l2"><a class="reference internal" href="levels.html#registering-components">Registering components</a></li>
<li class="toctree-l2"><a class="reference internal" href="levels.html#registering-systems">Registering Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="levels.html#creating-entities">Creating entities</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Entities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#entity-ids">Entity IDs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#index">Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generational-index">Generational Index</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#creating-an-entity">Creating an entity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="components.html#creating-components">Creating components</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html#registering-components">Registering components</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html#adding-components">Adding components</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html#checking-getting-components">Checking &amp; getting components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="systems.html">Systems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="systems.html#template">Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="systems.html#registering-a-system">Registering a system</a></li>
<li class="toctree-l2"><a class="reference internal" href="systems.html#entities-list-iterator">Entities list iterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="systems.html#accessing-entities-in-a-system">Accessing Entities in a system</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rendering.html">Rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Input</a><ul>
<li class="toctree-l2"><a class="reference internal" href="input.html#available-keys">Available Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="input.html#different-key-presses">Different Key Presses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input.html#key-press">Key Press</a></li>
<li class="toctree-l3"><a class="reference internal" href="input.html#key-hold">Key Hold</a></li>
<li class="toctree-l3"><a class="reference internal" href="input.html#key-release">Key Release</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="logging.html#printing">Printing</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/rendering/rendering_sprite.html">Rendering a Sprite</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/typedef_zel_system_t.html">zel_system_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_camera_t.html">zel_camera_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_entities_list.html">zel_entities_list</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_generational_ptr.html">zel_generational_ptr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_level_t.html">zel_level_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_material_t.html">zel_material_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_mesh_t.html">zel_mesh_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_texture_t.html">zel_texture_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_transform_t.html">zel_transform_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_vector2.html">vector2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_vector3.html">vector3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/struct_zel_vector4.html">vector4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/class_ZelComponent.html">ZelComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/class_ZelComponentBase.html">ZelComponentBase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/file_zel_application_h.html">zel_application.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/file_zel_component_builtin_h.html">zel_component_builtin.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/file_zel_ecs_h.html">zel_ecs.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/file_zel_level_h.html">zel_level.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/file_zel_render_api_h.html">zel_render_api.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/file_zel_resources_h.html">zel_resources.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/file_zel_types_h.html">zel_types.h</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Zel Game Engine</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Entities</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/basics/entities.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="entities">
<span id="id1"></span><h1>Entities<a class="headerlink" href="#entities" title="Permalink to this headline">¶</a></h1>
<p>Entities represent the concept of game objects.
A player can be an entity, an enemy can be an entity and a camera can also be represented as an entity.</p>
<p>You may look at an entity like a container of components.
You combine certain components together by adding it to an entity.
This way you can construct, for example, the player.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Entities and Components work differently compared to most popular engines. Please read through the <a class="reference external" href="https://nvriezen.github.io/ZelMigrationGuide/">Migration Guide</a> to understand better how to use Entities and Components in the Zel Game Engine.</p>
</div>
<div class="section" id="entity-ids">
<h2>Entity IDs<a class="headerlink" href="#entity-ids" title="Permalink to this headline">¶</a></h2>
<p>Entities in this engine’s implementation are nothing more than 32-bit integers.</p>
<div class="section" id="index">
<h3>Index<a class="headerlink" href="#index" title="Permalink to this headline">¶</a></h3>
<p>The bottom 24 bits, 0 to 23, represent an index. With this index an entity can be identified as it represents its position in an array, from here on called entity spot.
Components can use this entity index to map components to that particular entity.</p>
</div>
<div class="section" id="generational-index">
<h3>Generational Index<a class="headerlink" href="#generational-index" title="Permalink to this headline">¶</a></h3>
<p>The top 8 bits, 24 to 31, are the generational index.
This is a special value which gets increased everytime an entity spot changes.
So when an entity gets created or destroyed in that spot.</p>
<p>When trying to get a component through an entity id, the generational index is compared.
If the generational index in that entity spot is different than the generational index in the entity id, it indicates the entity does not actually have that component or has been destroyed.</p>
<div class="toggle admonition">
<p class="admonition-title">Click me to learn more</p>
<p>Components get stored in a class specific for that component type.
Systems are just functions which get tracked by the level.
Therefore Entities only have to be a unique number for them to work.
With that unique ID we can identify groups of components.</p>
<p>We use the generational index for some security and robustness.
There are macros in the <code class="docutils literal notranslate"><span class="pre">zel_entities.h</span></code> file to help make an ID from an index and a generational index.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#define ZEL_CAPACITY_GENERATION 0xFF</span>
<span class="cp">#define ZEL_CAPACITY_ENTITIES 0xFFFFFF</span>
<span class="cp">#define ZEL_MAX_ENTITIES 0xFFFF</span>
<span class="cp">#define ZEL_GENERATION_BIT 24</span>

<span class="cp">#define ZEL_GET_GENERATION(id) ((id &amp; 0xFF000000) &gt;&gt; ZEL_GENERATION_BIT)</span>
<span class="cp">#define ZEL_GET_INDEX(id) (id &amp; ZEL_CAPACITY_ENTITIES)</span>
<span class="cp">#define ZEL_CREATE_ID(generation, index) (generation &lt;&lt; ZEL_GENERATION_BIT) | index</span>
</pre></div>
</div>
<p>Entities are simply stored inside <code class="docutils literal notranslate"><span class="pre">zel_level_t</span></code>.
The position inside the <code class="docutils literal notranslate"><span class="pre">std::vector</span></code>, the index, decides part of their ID. The index in that vector is also the index used in the Component class for the mapping of components.
So the data in <code class="docutils literal notranslate"><span class="pre">entity_to_component</span></code> points to the component that is attached to a particular entity.
If the entity has index 2 in the level struct, then its components can be found in <code class="docutils literal notranslate"><span class="pre">entity_to_component[2]</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="o">*</span> <span class="nf">get_component</span><span class="p">(</span><span class="n">zel_entity_id</span> <span class="n">entity</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">zel_index</span> <span class="n">entity_index</span> <span class="o">=</span> <span class="n">ZEL_GET_INDEX</span><span class="p">(</span><span class="n">entity</span><span class="p">);</span>
        <span class="n">zel_generation</span> <span class="n">entity_generation</span> <span class="o">=</span> <span class="n">ZEL_GET_GENERATION</span><span class="p">(</span><span class="n">entity</span><span class="p">);</span>
        <span class="n">zel_generational_ptr</span> <span class="n">component_pointer</span> <span class="o">=</span> <span class="n">entity_to_component</span><span class="p">[</span><span class="n">entity_index</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">component_pointer</span><span class="p">.</span><span class="n">generation</span> <span class="o">!=</span> <span class="n">entity_generation</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="n">zel_print</span><span class="p">(</span><span class="s">&quot;[zel_component class] get component return nullptr | Entity: %d | Type: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="k">typeid</span><span class="p">(</span><span class="n">T</span><span class="p">).</span><span class="n">name</span><span class="p">());</span>
                <span class="k">return</span> <span class="k">nullptr</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">zel_index</span> <span class="n">component_index</span> <span class="o">=</span> <span class="n">ZEL_GET_INDEX</span><span class="p">(</span><span class="n">component_pointer</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
        <span class="k">return</span> <span class="o">&amp;</span><span class="n">components</span><span class="p">[</span><span class="n">component_index</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="creating-an-entity">
<h2>Creating an entity<a class="headerlink" href="#creating-an-entity" title="Permalink to this headline">¶</a></h2>
<p>Entities need to be created through a level.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">zel_entity_id</span> <span class="n">entity</span> <span class="o">=</span> <span class="n">zel_level_create_entity</span><span class="p">(</span><span class="n">example_level</span><span class="p">);</span>
</pre></div>
</div>
<p>As you can see the function <code class="docutils literal notranslate"><span class="pre">zel_level_create_entity</span></code> returns a <code class="docutils literal notranslate"><span class="pre">zel_entity_id</span></code>.
This is nothing more than a type definition.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">uint32_t</span> <span class="n">zel_entity_id</span><span class="p">;</span>
</pre></div>
</div>
<p>A 32-bit unsigned integer is used to represent an entity id, as was mentioned above. To learn more about how an entity id gets constructed, please see <a class="reference external" href="https://github.com/NVriezen/ZelGameEngine/blob/master/ZelGameEngine/include/zel_ecs.h#L11">zel_ecs.h</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="components.html" class="btn btn-neutral float-right" title="Components" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="levels.html" class="btn btn-neutral float-left" title="Levels" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, NVriezen.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .admonition-title").show();
        $(".toggle .admonition-title").click(function() {
            $(this).parent().children().not(".admonition-title").toggle(200);
            $(this).parent().children(".admonition-title").toggleClass("open");
        })
    });
</script>


</body>
</html>